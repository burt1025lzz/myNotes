# 前端原理和源码

------



## 一、JS 内存泄漏如何检测？场景？

### 1. 垃圾回收 GC

+ 什么是垃圾回收？

+ 引用计数（之前）

  ```js
  // 对象被 a 引用
  let a = {
    	x: 100
  }
  let a1 = a
  a = 10
  a1 = null  // 此时 { x: 100 } 被引用次数为 0 ，就会被清除
  
  // 缺陷：循环引用会有问题
  function fn() {
      const obj1 = {}
      const obj2 = {}
      obj1.a = obj2
      obj2.a = obj1
  }
  fn()
  
  // IE6-7 内存泄露 BUG
  var div = document.getElementById('div')
  div.a = div
  div.someBigData = {}
  ```

+ 标记清除（现代）

  1. 会定时从 JS 根 window 开始逐步向下遍历，如果引用不到就会清除

### 2. ( 连环问 ) 闭包算内存泄漏吗？

+ 不算，属于用户期望，但是垃圾回收不掉

------



## 二、(连环问) 